<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiled Squares Display2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
        
        body {
            margin: 0;
            display: flex;
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            min-height: 100vh;
            background-color: #1B1B3A; 
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; 
            padding: 3vh 0;
        }

        .time-display {
            margin-top: 3vh; 
            color: #FBBBAD; 
            font-size: 1.5rem; 
            font-weight: 600;
            letter-spacing: 0.1em;
            text-shadow: 0 0 5px rgba(251, 187, 173, 0.2);
            text-align: center;
        }

        #main-canvas {
            width: 81vmin;
            height: 71vmin;
            display: grid;
            grid-template-columns: 5fr 3fr; 
            gap: 3vmin; 
            padding: 1vmin;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            border-radius: 12px;
            background-color: #292831; 
            flex-shrink: 0; 
        }
        
        .group-wrapper {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        #left-group, #right-group {
            display: grid;
            row-gap: 1vmin; 
            column-gap: 0.5vmin;
        }

        #left-group {
            grid-template-columns: repeat(5, 1fr); 
        }

        #right-group {
            grid-template-columns: repeat(3, 1fr); 
        }

        .square {
            height: 0; 
            width: 100%;
            padding-bottom: 100%; 
            border-radius: 4px;
            transition: background 0.5s ease-in-out, transform 0.2s ease-in-out;
            display: block;
        }

        .square:hover {
            transform: scale(1.05);
            z-index: 10;
        }
        
        #left-labels {
            display: grid;
            grid-template-columns: repeat(5, 1fr); 
        }

        #right-labels {
            display: grid;
            grid-template-columns: repeat(3, 1fr); 
        }

        #left-labels, #right-labels {
            row-gap: 0.5vmin;
            column-gap: 0.5vmin;
            margin-top: auto; 
            padding-top: 1.5vmin; 
        }

        .index-label-item {
            text-align: center;
            font-size: 1.5vmin; 
            font-weight: 500;
        }
    </style>
</head>
<body>
    
    <div id="main-canvas">
        <div class="group-wrapper" id="left-wrapper">
            <div id="left-group">
            </div>
            <div id="left-labels">
            </div>
        </div>
        
        <div class="group-wrapper" id="right-wrapper">
            <div id="right-group">
            </div>
            <div id="right-labels">
            </div>
        </div>
    </div>
    
    <div id="live-time" class="time-display">Loading Time...</div>

    <script>
        // Global variable for testing purposes. Set this in the console.
        // E.g., __TEST_CURRENT_TIME = 10 * 60 + 30; (for 10:30 AM)
        let __TEST_CURRENT_TIME = null; 
        
        document.addEventListener('DOMContentLoaded', () => {
            const leftGroup = document.getElementById('left-group');
            const rightGroup = document.getElementById('right-group');
            const leftLabels = document.getElementById('left-labels');
            const rightLabels = document.getElementById('right-labels');
            
            const totalSquares = 32;
            const leftCount = 20; 
            
            const PINK_UNFILLED_COLOR = '#FBBBAD';
            const PINK_FILLED_COLOR = '#EE8695'; 
            
            const BLUE_UNFILLED_COLOR = '#4A7A96';
            const BLUE_FILLED_COLOR = '#292831'; 
            
            const WAKE_START_MINUTES = 8 * 60; 
            const BLOCK_DURATION_MINUTES = 45; 
            const MINUTES_IN_DAY = 24 * 60; 

            function generateSquaresAndLabels(count, squareContainer, labelContainer, baseColor, startIndex, squarePrefix) {
                for (let i = 0; i < count; i++) {
                    const index = startIndex + i;
                    const color = (index < leftCount) ? PINK_UNFILLED_COLOR : BLUE_UNFILLED_COLOR;

                    const square = document.createElement('div');
                    square.classList.add('square', squarePrefix + '-square');
                    square.id = `square-${index}`; 
                    square.style.background = color; 
                    squareContainer.appendChild(square);
                    
                    const labelItem = document.createElement('div');
                    labelItem.classList.add('index-label-item');
                    labelItem.textContent = index;
                    labelItem.style.color = color; 
                    
                    labelContainer.appendChild(labelItem);
                }
            }

            generateSquaresAndLabels(leftCount, leftGroup, leftLabels, PINK_UNFILLED_COLOR, 0, 'pink');
            const rightCount = totalSquares - leftCount; 
            generateSquaresAndLabels(rightCount, rightGroup, rightLabels, BLUE_UNFILLED_COLOR, leftCount, 'blue');
            
            function updateTimeDisplay(now) {
                const timeString = now.toLocaleTimeString('en-US', {
                    hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true
                });
                const dateString = now.toLocaleDateString('en-US', {
                    weekday: 'short', month: 'short', day: 'numeric'
                });

                const timeElement = document.getElementById('live-time');
                if (timeElement) {
                    timeElement.innerHTML = `${dateString} &nbsp; | &nbsp; ${timeString}`;
                }
            }

            function updateVisualization() {
                let currentMinutesSinceMidnight;
                const timeElement = document.getElementById('live-time');

                if (__TEST_CURRENT_TIME !== null && typeof __TEST_CURRENT_TIME === 'number') {
                    // --- TEST MODE ---
                    currentMinutesSinceMidnight = (__TEST_CURRENT_TIME % MINUTES_IN_DAY + MINUTES_IN_DAY) % MINUTES_IN_DAY;
                    
                    const testHours = Math.floor(currentMinutesSinceMidnight / 60);
                    const testMinutes = currentMinutesSinceMidnight % 60;
                    
                    // Format time string for display (e.g., 08:00)
                    const paddedHours = String(testHours).padStart(2, '0');
                    const paddedMinutes = String(testMinutes).padStart(2, '0');
                    
                    if (timeElement) {
                        timeElement.innerHTML = `TEST MODE | ${paddedHours}:${paddedMinutes}`;
                    }
                } else {
                    // --- LIVE MODE ---
                    const now = new Date();
                    currentMinutesSinceMidnight = now.getHours() * 60 + now.getMinutes();
                    updateTimeDisplay(now);
                }

                let minutesElapsed = currentMinutesSinceMidnight - WAKE_START_MINUTES;
                
                if (minutesElapsed < 0) {
                    minutesElapsed += MINUTES_IN_DAY; 
                }
                
                const totalBlocksElapsed = Math.floor(minutesElapsed / BLOCK_DURATION_MINUTES);
                
                const minutesInCurrentBlock = minutesElapsed % BLOCK_DURATION_MINUTES;
                
                const fillPercentage = (minutesInCurrentBlock / BLOCK_DURATION_MINUTES) * 100;

                for (let i = 0; i < totalSquares; i++) {
                    const square = document.getElementById(`square-${i}`);
                    if (!square) continue;

                    const isPinkGroup = i < leftCount;
                    const unfilledColor = isPinkGroup ? PINK_UNFILLED_COLOR : BLUE_UNFILLED_COLOR;
                    const filledColor = isPinkGroup ? PINK_FILLED_COLOR : BLUE_FILLED_COLOR;

                    if (i < totalBlocksElapsed) {
                        square.style.background = filledColor;
                    } else if (i === totalBlocksElapsed && i < totalSquares) {
                        const gradient = `linear-gradient(to right, ${filledColor} ${fillPercentage}%, ${unfilledColor} ${fillPercentage}%)`;
                        square.style.background = gradient;
                    } else {
                        square.style.background = unfilledColor;
                    }
                }
            }

            updateVisualization();
            
            setInterval(updateVisualization, 2000);
        });
    </script>
</body>
</html>